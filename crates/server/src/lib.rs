pub(crate) mod db;

use anyhow::Result;

#[derive(Clone, Debug)]
pub struct State {
    /// The port which will be used to listen for connections.
    pub port: u16,

    /// The directory to store malware samples, if we're keeping them.
    pub directory: Option<String>,

    /// Database connection string
    pub database_connection: String,
}

impl State {
    pub fn new(port: u16, directory: Option<String>, db_string: &str) -> Result<Self> {
        let _db_type = db::DatabaseType::from_string(db_string)?;
        Ok(Self {
            port,
            directory,
            database_connection: db_string.into(),
        })
    }
}
