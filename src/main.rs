use anyhow::Context;
use clap::Parser;
use confargs::{prefix_char_filter, Toml};

#[derive(Clone, Debug, Parser)]
#[command(author, version, about)]
pub struct Args {
    /// The port which will be used to listen for connections.
    #[arg(short, long, default_value = "8443")]
    pub port: u16,

    /// The directory to store malware samples, if we're keeping them.
    pub directory: Option<String>,

    /// Database connection string
    pub database_connection: String,
}

fn main() -> anyhow::Result<()> {
    let _args = confargs::args::<Toml>(prefix_char_filter::<'@'>)
        .context("Failed to parse config")
        .map(Args::parse_from)?;
    println!("Hello, world!");
    Ok(())
}
