#[cfg(feature = "admin")]
mod admin;
mod config;
mod run;

use std::process::ExitCode;

use clap::{Parser, Subcommand};

/// Malware Database
///
/// Malware Database maintains the bookkeeping for unknown, malicious, and benign binaries
/// using a database, and optionally storing the files in a given location for later retrieval.
#[derive(Parser, Debug, Clone, PartialEq)]
#[command(author, version, about)]
pub struct Options {
    /// Subcommands (with their own options)
    #[clap(subcommand)]
    cmd: Subcommands,
}

impl Options {
    pub fn execute(self) -> anyhow::Result<ExitCode> {
        match self.cmd {
            Subcommands::Run(cmd) => cmd.execute(),
            #[cfg(feature = "admin")]
            Subcommands::Admin(cmd) => cmd.execute(),
        }
    }
}

#[derive(Subcommand, Clone, Debug, PartialEq)]
enum Subcommands {
    Run(run::Run),
    #[cfg(feature = "admin")]
    Admin(admin::Admin),
}
